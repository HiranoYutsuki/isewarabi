<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>伊勢神宮へようこそ</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
      body { font-family: sans-serif; text-align: center; background: #f5f5f5; }
      #reader { width: 300px; margin: 20px auto; }
      #result { margin-top: 20px; font-size: 18px; }
      button { padding: 10px 20px; margin-top: 15px; font-size: 16px; }
    </style>
  </head>
  <body>
    <h2>QRコードスキャナ</h2>
  <div id="reader"></div>
  <div id="result">読み取り結果：なし</div>

  <script>
    // 成功時の処理
    function onScanSuccess(decodedText) {
      document.getElementById("result").innerText = "読み取り結果: " + decodedText;
      
      // URLっぽい文字列ならそのまま開く
      if (decodedText.startsWith("http://") || decodedText.startsWith("https://")) {
        window.location.href = decodedText;
      }
    }

    // エラー時の処理（あまり表示しないようにしてある）
    function onScanFailure(error) {
      // console.log(`読み取りエラー: ${error}`);
    }

    // QRコードリーダーを起動
    let html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start(
      { facingMode: "environment" }, // 背面カメラを使用
      { fps: 10, qrbox: 250 },       // 読み取り設定
      onScanSuccess,
      onScanFailure
    );
  </script>
  </body>
</html>
